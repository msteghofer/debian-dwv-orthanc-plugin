From: =?utf-8?q?Martin_Stegh=C3=B6fer?= <martin@steghoefer.eu>
Date: Thu, 22 Oct 2015 21:39:39 +0200
Subject: Install the library.

---
 CMakeLists.txt | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index e03ab31..d9b0829 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -31,6 +31,18 @@ EmbedResources( DWV_EXPLORER ${CMAKE_CURRENT_SOURCE_DIR}/Explorer )
 # create library
 add_library(${PROJECT_NAME} SHARED Plugin.cpp ${AUTOGENERATED_SOURCES})
 
+# install library
+install(TARGETS ${PROJECT_NAME} LIBRARY DESTINATION lib/orthanc)
+
+# create and install symlink to activate plugin in orthanc
+file(MAKE_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/plugins)
+add_custom_command(TARGET ${PROJECT_NAME} POST_BUILD
+    COMMAND ${CMAKE_COMMAND} -E create_symlink
+            ${CMAKE_INSTALL_PREFIX}/lib/orthanc/$<TARGET_FILE_NAME:${PROJECT_NAME}>
+            ${CMAKE_CURRENT_BINARY_DIR}/plugins/$<TARGET_FILE_NAME:${PROJECT_NAME}>
+    )
+install(DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/plugins DESTINATION share/orthanc)
+
 if (${CMAKE_SYSTEM_NAME} STREQUAL "Linux")
   # Linking with "pthread" is necessary, otherwise the software crashes
   # http://sourceware.org/bugzilla/show_bug.cgi?id=10652#c17
